#!/usr/bin/env bash
set -euo pipefail

ROOT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
JAVA_VERSION_FILE="$ROOT_DIR/.java-version"

JAVA_VERSION="25"
if [[ -f "$JAVA_VERSION_FILE" ]]; then
  JAVA_VERSION="$(tr -d '[:space:]' < "$JAVA_VERSION_FILE")"
fi

if [[ -x "/usr/libexec/java_home" ]]; then
  export JAVA_HOME="$(/usr/libexec/java_home -v "$JAVA_VERSION")"
fi
export PATH="$JAVA_HOME/bin:$PATH"

echo "Using JAVA_HOME=$JAVA_HOME"
exec mvn "$@"
